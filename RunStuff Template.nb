(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    161622,       3738]
NotebookOptionsPosition[    159274,       3689]
NotebookOutlinePosition[    159694,       3706]
CellTagsIndexPosition[    159651,       3703]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Dialog", " ", "prompt", " ", "to", " ", "fix", " ", 
    RowBox[{"in", "/", "out"}], " ", 
    RowBox[{"paths", ".", "  ", "Can"}], " ", "be", " ", "replaced", " ", 
    "with", " ", "direct", " ", "path", " ", "input", " ", "later"}], "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"id", "=", 
     RowBox[{"ChoiceDialog", "[", "\n", 
      RowBox[{
      "\"\<It's dangerous to go alone! Who are you and your computer \
companion?\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<Sam & Cuchulain\>\"", "->", " ", "\"\<Sam\>\""}], ",", 
         " ", 
         RowBox[{"\"\<Sherwood & Ganon\>\"", "->", "\"\<Sherwood\>\""}], ",", 
         RowBox[{"\"\<Someone new\>\"", "->", "\"\<Other\>\""}]}], "}"}]}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Sets", " ", "the", " ", "paths", " ", "based", " ", "on", " ", "the", 
     " ", "machine", " ", 
     RowBox[{"pick", ".", "  ", "The"}], " ", "paths", " ", "are", " ", 
     "global"}], "*)"}], "\n", " ", 
   RowBox[{
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"id", "==", "\"\<Sam\>\""}], ",", "\n", " ", 
      RowBox[{
       RowBox[{
       "inpath", "=", 
        "\"\<G:\\\\My Drive\\\\Physics\\\\Neutrino Oscillation \
Research\\\\Fast Conversions\\\\lotsadata.tar\\\\lotsadata\\\\lotsadata\\\\\>\
\""}], ";", "\n", " ", 
       RowBox[{
       "outpath", "=", 
        "\"\<G:\\\\My Drive\\\\Physics\\\\Neutrino Oscillation \
Research\\\\Fast Conversions\\\\stability_data\\\\\>\""}], ";"}], "\n", " ", 
      ",", "\n", " ", 
      RowBox[{"id", "==", "\"\<Sherwood\>\""}], ",", "\n", " ", 
      RowBox[{
       RowBox[{"inpath", "=", "\"\</mnt/data/SamFlynn/lotsadata/\>\""}], ";", 
       "\n", " ", 
       RowBox[{"outpath", "=", "\"\</mnt/data/SamFlynn/stability_data/\>\""}],
        ";"}], "\n", " ", ",", "\n", " ", 
      RowBox[{"id", "==", "\"\<Other\>\""}], ",", "\n", " ", 
      RowBox[{
       RowBox[{"inpath", " ", "=", " ", 
        RowBox[{"SystemDialogInput", "[", 
         RowBox[{"\"\<Directory\>\"", ",", 
          RowBox[{
          "WindowTitle", "->", " ", 
           "\"\<Choose the folder containing the data set\>\""}]}], "]"}]}], 
       ";", "\n", " ", 
       RowBox[{"outpath", " ", "=", " ", 
        RowBox[{"inpath", "<>", "\"\<out\\\\\>\""}]}], ";"}]}], "\n", " ", 
     "]"}], ";"}], "\n", " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Want", " ", "to", " ", "implements", " ", "toggle", " ", "grid", " ", 
      "here", " ", "to", " ", "pick", " ", "between", " ", "the", " ", "mass",
       " ", "models", " ", "and", " ", "time", " ", 
      RowBox[{"slices", ".", "  ", 
       RowBox[{"It", "'"}]}], "s", " ", "easy"}], ",", " ", 
     RowBox[{
     "but", " ", "definitely", " ", "not", " ", "a", " ", "priority"}]}], 
    "*)"}], "\n", 
   RowBox[{"(*", "\n", 
    RowBox[{
     RowBox[{"filename", " ", "=", " ", "\"\<15Msun_50ms_DO\>\""}], ";", "\n", 
     RowBox[{"infile", " ", "=", " ", 
      RowBox[{"inpath", "<>", "filename", "<>", "\"\<.h5\>\""}]}], ";", "\n", 
     RowBox[{"outfolder", " ", "=", " ", 
      RowBox[{"outpath", "<>", "filename"}]}], ";"}], "\n", "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Note", ":", " ", 
       RowBox[{
       "this", " ", "used", " ", "to", " ", "contain", " ", "a", " ", 
        "variable", " ", "called", " ", 
        RowBox[{"\"\<out_path\>\"", ".", " ", "Be"}], " ", "careful", " ", 
        "with", " ", "the", " ", "underscores"}]}], ";", " ", 
      RowBox[{
      "in", " ", "Mathematica", " ", "they", " ", "are", " ", "either", " ", 
       "function", " ", "inputs", " ", "or", " ", 
       RowBox[{"patterns", ".", "  ", "If"}], " ", "the", " ", "font", " ", 
       "turn", " ", "green"}]}], ",", " ", 
     RowBox[{
      RowBox[{"that", "'"}], "s", " ", 
      RowBox[{"why", "."}]}]}], "*)"}], "\n", 
   RowBox[{"(*", "Constants", "*)"}], "\n"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.800281436296136*^9, 3.8002814409021463`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"91436ba2-a31f-4384-98d7-fc2cb56064d1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  "\"\<C:\\\\Users\\\\Sam\\\\Documents\\\\GitHub\\\\stability_tools\>\"", 
  "]"}], "\n", 
 RowBox[{"<<", "\"\<StabilityPackage`\>\""}]}], "Input",
 InitializationCell->True,
 CellLabel->"In[3]:=",ExpressionUUID->"bdb6e7cd-c239-47d9-b167-de18ebb8b40a"],

Cell[BoxData["\<\"C:\\\\Users\\\\Sam\\\\Documents\\\\GitHub\\\\stability_\
tools\"\>"], "Output",
 CellChangeTimes->{{3.8013988557444763`*^9, 3.801398859785906*^9}, 
   3.801399045690092*^9, 3.801399168602594*^9, 3.801399427782333*^9, 
   3.8013995484983816`*^9, 3.8014003009920654`*^9, 3.8018191669354663`*^9, 
   3.8018253656558533`*^9, 3.801826800948448*^9, 3.801826986930667*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"e8c1305f-90e1-4c90-a016-918bdadb931d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"?", "stabilityMatrix"}], "\[IndentingNewLine]", 
 RowBox[{"?", "getEquations"}], "\[IndentingNewLine]", 
 RowBox[{"?", "buildHamiltonians"}]}], "Input",
 CellChangeTimes->{{3.8013990477305393`*^9, 3.801399067755871*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"bdd8f3fb-c826-41e0-b21f-cb454beab10c"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"[data,Equations of motion (getEquations output)]. \
Returns the stability matrix\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False, False, False, False, 
                False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Definitions\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Definitions", "Tooltip"]& ], GridBox[{
                    {
                    RowBox[{
                    RowBox[{"stabilityMatrix", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data_", ",", 
                    "StabililtyPackage`Private`ea_"}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`S1", ",", 
                    "StabililtyPackage`Private`S2", ",", 
                    "StabililtyPackage`Private`S3", ",", 
                    "StabililtyPackage`Private`S4", ",", 
                    "StabililtyPackage`Private`S", ",", 
                    "StabililtyPackage`Private`n"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"StabililtyPackage`Private`n", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"mids\"\>", 
                    "]"}], "]"}]}], ";", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"StabililtyPackage`Private`eqn", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`ea", "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`eqnb", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`ea", "\[LeftDoubleBracket]", 
                    "2", "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`A", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`ea", "\[LeftDoubleBracket]", 
                    "3", "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`Ab", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`ea", "\[LeftDoubleBracket]", 
                    "4", "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"StabililtyPackage`Private`S1", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`eqn", "[", 
                    "StabililtyPackage`Private`l", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`A", "[", 
                    "StabililtyPackage`Private`m", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`l", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`m", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"StabililtyPackage`Private`S2", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`eqn", "[", 
                    "StabililtyPackage`Private`l", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`Ab", "[", 
                    "StabililtyPackage`Private`m", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`l", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`m", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"StabililtyPackage`Private`S3", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`eqnb", "[", 
                    "StabililtyPackage`Private`l", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`A", "[", 
                    "StabililtyPackage`Private`m", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`l", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`m", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"StabililtyPackage`Private`S4", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`eqnb", "[", 
                    "StabililtyPackage`Private`l", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`Ab", "[", 
                    "StabililtyPackage`Private`m", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`l", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`m", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"StabililtyPackage`Private`S", "=", 
                    RowBox[{
                    RowBox[{"ArrayFlatten", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"StabililtyPackage`Private`S1", ",", 
                    "StabililtyPackage`Private`S2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`S3", ",", 
                    "StabililtyPackage`Private`S4"}], "}"}]}], "}"}], "]"}], "/.",
                     "\[VeryThinSpace]", 
                    RowBox[{
                    "StabililtyPackage`Private`rules", "[", 
                    "StabililtyPackage`Private`n", "]"}]}]}], ";", 
                    RowBox[{
                    "Return", "[", "StabililtyPackage`Private`S", "]"}], 
                    ";"}]}], "]"}]}]}], "]"}]}]}
                    },
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"StabililtyPackage`stabilityMatrix\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->6], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"[data,Equations of motion (getEquations output)]. \
Returns the stability matrix\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{15., {4., 11.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{15., {4., 11.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    "[data,Equations of motion (getEquations output)]. Returns the stability \
matrix", "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> 
    Information`InformationValueForm[
     DownValues, StabililtyPackage`stabilityMatrix, {
      StabililtyPackage`stabilityMatrix[
         Pattern[StabililtyPackage`Private`data, 
          Blank[]], 
         Pattern[StabililtyPackage`Private`ea, 
          Blank[]]] :> 
       Module[{StabililtyPackage`Private`S1, StabililtyPackage`Private`S2, 
          StabililtyPackage`Private`S3, StabililtyPackage`Private`S4, 
          StabililtyPackage`Private`S, StabililtyPackage`Private`n}, 
         StabililtyPackage`Private`n = Length[
            StabililtyPackage`Private`data["mids"]]; 
         With[{StabililtyPackage`Private`eqn = 
            Part[StabililtyPackage`Private`ea, 1], 
            StabililtyPackage`Private`eqnb = 
            Part[StabililtyPackage`Private`ea, 2], 
            StabililtyPackage`Private`A = 
            Part[StabililtyPackage`Private`ea, 3], 
            StabililtyPackage`Private`Ab = 
            Part[StabililtyPackage`Private`ea, 4]}, 
           StabililtyPackage`Private`S1 = Table[
              Coefficient[
               StabililtyPackage`Private`eqn[StabililtyPackage`Private`l], 
               Part[
                StabililtyPackage`Private`A[StabililtyPackage`Private`m], 1, 
                2]], {StabililtyPackage`Private`l, 1, 
               StabililtyPackage`Private`n}, {
              StabililtyPackage`Private`m, 1, StabililtyPackage`Private`n}]; 
           StabililtyPackage`Private`S2 = Table[
              Coefficient[
               StabililtyPackage`Private`eqn[StabililtyPackage`Private`l], 
               Part[
                StabililtyPackage`Private`Ab[StabililtyPackage`Private`m], 1, 
                2]], {StabililtyPackage`Private`l, 1, 
               StabililtyPackage`Private`n}, {
              StabililtyPackage`Private`m, 1, StabililtyPackage`Private`n}]; 
           StabililtyPackage`Private`S3 = Table[
              Coefficient[
               StabililtyPackage`Private`eqnb[StabililtyPackage`Private`l], 
               Part[
                StabililtyPackage`Private`A[StabililtyPackage`Private`m], 1, 
                2]], {StabililtyPackage`Private`l, 1, 
               StabililtyPackage`Private`n}, {
              StabililtyPackage`Private`m, 1, StabililtyPackage`Private`n}]; 
           StabililtyPackage`Private`S4 = Table[
              Coefficient[
               StabililtyPackage`Private`eqnb[StabililtyPackage`Private`l], 
               Part[
                StabililtyPackage`Private`Ab[StabililtyPackage`Private`m], 1, 
                2]], {StabililtyPackage`Private`l, 1, 
               StabililtyPackage`Private`n}, {
              StabililtyPackage`Private`m, 1, StabililtyPackage`Private`n}]; 
           StabililtyPackage`Private`S = ReplaceAll[
              
              ArrayFlatten[{{
                StabililtyPackage`Private`S1, StabililtyPackage`Private`S2}, {
                StabililtyPackage`Private`S3, StabililtyPackage`Private`S4}}], 
              StabililtyPackage`Private`rules[StabililtyPackage`Private`n]]; 
           Return[StabililtyPackage`Private`S]; Null]]}], "SubValues" -> None,
     "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> None, "Attributes" -> {}, "FullName" -> 
    "StabililtyPackage`stabilityMatrix"], False]]], "Output",
 CellChangeTimes->{{3.8013990546700478`*^9, 3.8013990683569994`*^9}, 
   3.801399170388995*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"0d74f071-1761-4185-ac38-8fd59b745e91"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"[data,test energy, hierarchy=-1/1, k]. Return the \
equations of motions\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False, False, False, False, 
                False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Definitions\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Definitions", "Tooltip"]& ], GridBox[{
                    {
                    RowBox[{
                    RowBox[{"getEquations", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data_", ",", 
                    "StabililtyPackage`Private`testE_", ",", 
                    "StabililtyPackage`Private`hi_", ",", 
                    "StabililtyPackage`Private`k_", ",", 
                    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`n", ",", 
                    "StabililtyPackage`Private`\[Theta]", ",", 
                    "StabililtyPackage`Private`eqn", ",", 
                    "StabililtyPackage`Private`eqnb", ",", 
                    "StabililtyPackage`Private`hs"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"dh\"\>", "]"}], ",", 
                    RowBox[{"StabililtyPackage`Private`hs", "=", 
                    RowBox[{"buildHamiltonians", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data", ",", 
                    "StabililtyPackage`Private`testE", ",", 
                    "StabililtyPackage`Private`hi"}], "]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`hs", "=", 
                    RowBox[{"buildHamiltonians", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data", ",", 
                    "StabililtyPackage`Private`testE", ",", 
                    "StabililtyPackage`Private`hi", ",", 
                    RowBox[{"\<\"dh\"\>", "\[Rule]", "False"}]}], "]"}]}]}], 
                    "]"}], ";", 
                    RowBox[{"StabililtyPackage`Private`n", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"mids\"\>", 
                    "]"}], "]"}]}], ";", 
                    RowBox[{"StabililtyPackage`Private`\[Theta]", "=", 
                    RowBox[{"ArcCos", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"mids\"\>", 
                    "]"}], "]"}]}], ";", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"StabililtyPackage`Private`H", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`hs", "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`Hb", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`hs", "\[LeftDoubleBracket]", 
                    "2", "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`\[Rho]", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`hs", "\[LeftDoubleBracket]", 
                    "3", "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`\[Rho]b", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`hs", "\[LeftDoubleBracket]", 
                    "4", "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`A", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`hs", "\[LeftDoubleBracket]", 
                    "5", "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`Ab", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`hs", "\[LeftDoubleBracket]", 
                    "6", "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`\[Delta]H", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`hs", "\[LeftDoubleBracket]", 
                    "7", "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`\[Delta]Hb", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`hs", "\[LeftDoubleBracket]", 
                    "8", "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`eqn", "[", 
                    "StabililtyPackage`Private`j", "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StabililtyPackage`Private`Com", "[", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`H", "[", 
                    "StabililtyPackage`Private`j", "]"}], ",", 
                    RowBox[{
                    "StabililtyPackage`Private`A", "[", 
                    "StabililtyPackage`Private`j", "]"}]}], "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    RowBox[{"StabililtyPackage`Private`Com", "[", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Delta]H", "[", 
                    "StabililtyPackage`Private`j", "]"}], ",", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Rho]", "[", 
                    "StabililtyPackage`Private`j", "]"}]}], "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"StabililtyPackage`Private`k", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Theta]", 
                    "\[LeftDoubleBracket]", "StabililtyPackage`Private`j", 
                    "\[RightDoubleBracket]"}], "]"}], " ", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`A", "[", 
                    "StabililtyPackage`Private`j", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`eqnb", "[", 
                    "StabililtyPackage`Private`j", "]"}], "=", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"StabililtyPackage`Private`Com", "[", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`Hb", "[", 
                    "StabililtyPackage`Private`j", "]"}], ",", 
                    RowBox[{
                    "StabililtyPackage`Private`Ab", "[", 
                    "StabililtyPackage`Private`j", "]"}]}], "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
                    RowBox[{
                    RowBox[{"StabililtyPackage`Private`Com", "[", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Delta]Hb", "[", 
                    "StabililtyPackage`Private`j", "]"}], ",", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Rho]b", "[", 
                    "StabililtyPackage`Private`j", "]"}]}], "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"StabililtyPackage`Private`k", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Theta]", 
                    "\[LeftDoubleBracket]", "StabililtyPackage`Private`j", 
                    "\[RightDoubleBracket]"}], "]"}], " ", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`Ab", "[", 
                    "StabililtyPackage`Private`j", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}]}]}], 
                    ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`j", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}]}], "]"}], ";", 
                    RowBox[{"Return", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`eqn", ",", 
                    "StabililtyPackage`Private`eqnb", ",", 
                    "StabililtyPackage`Private`A", ",", 
                    "StabililtyPackage`Private`Ab"}], "}"}], "]"}]}]}], 
                    "]"}]}]}], "]"}]}]}
                    },
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Options\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Options\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Options", "Tooltip"]& ], 
                   RowBox[{"\<\"dh\"\>", "\[Rule]", "True"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"StabililtyPackage`getEquations\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->6], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"[data,test energy, hierarchy=-1/1, k]. Return the \
equations of motions\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{15., {4., 11.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{15., {4., 11.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    "[data,test energy, hierarchy=-1/1, k]. Return the equations of motions", 
    "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> 
    Information`InformationValueForm[
     DownValues, StabililtyPackage`getEquations, {
      StabililtyPackage`getEquations[
         Pattern[StabililtyPackage`Private`data, 
          Blank[]], 
         Pattern[StabililtyPackage`Private`testE, 
          Blank[]], 
         Pattern[StabililtyPackage`Private`hi, 
          Blank[]], 
         Pattern[StabililtyPackage`Private`k, 
          Blank[]], 
         OptionsPattern[]] :> 
       Module[{StabililtyPackage`Private`n, 
          StabililtyPackage`Private`\[Theta], StabililtyPackage`Private`eqn, 
          StabililtyPackage`Private`eqnb, StabililtyPackage`Private`hs}, If[
           OptionValue["dh"], StabililtyPackage`Private`hs = 
           StabililtyPackage`buildHamiltonians[
            StabililtyPackage`Private`data, StabililtyPackage`Private`testE, 
             StabililtyPackage`Private`hi], StabililtyPackage`Private`hs = 
           StabililtyPackage`buildHamiltonians[
            StabililtyPackage`Private`data, StabililtyPackage`Private`testE, 
             StabililtyPackage`Private`hi, "dh" -> False]]; 
         StabililtyPackage`Private`n = Length[
            StabililtyPackage`Private`data["mids"]]; 
         StabililtyPackage`Private`\[Theta] = ArcCos[
            StabililtyPackage`Private`data["mids"]]; 
         With[{StabililtyPackage`Private`H = 
            Part[StabililtyPackage`Private`hs, 1], 
            StabililtyPackage`Private`Hb = 
            Part[StabililtyPackage`Private`hs, 2], 
            StabililtyPackage`Private`\[Rho] = 
            Part[StabililtyPackage`Private`hs, 3], 
            StabililtyPackage`Private`\[Rho]b = 
            Part[StabililtyPackage`Private`hs, 4], 
            StabililtyPackage`Private`A = 
            Part[StabililtyPackage`Private`hs, 5], 
            StabililtyPackage`Private`Ab = 
            Part[StabililtyPackage`Private`hs, 6], 
            StabililtyPackage`Private`\[Delta]H = 
            Part[StabililtyPackage`Private`hs, 7], 
            StabililtyPackage`Private`\[Delta]Hb = 
            Part[StabililtyPackage`Private`hs, 8]}, 
           Do[StabililtyPackage`Private`eqn[StabililtyPackage`Private`j] = 
              Part[
                 StabililtyPackage`Private`Com[
                  StabililtyPackage`Private`H[StabililtyPackage`Private`j], 
                  StabililtyPackage`Private`A[StabililtyPackage`Private`j]], 
                 1, 2] + Part[
                 StabililtyPackage`Private`Com[
                  StabililtyPackage`Private`\[Delta]H[
                  StabililtyPackage`Private`j], 
                  StabililtyPackage`Private`\[Rho][
                  StabililtyPackage`Private`j]], 1, 2] + 
               StabililtyPackage`Private`k Cos[
                  Part[
                  StabililtyPackage`Private`\[Theta], 
                   StabililtyPackage`Private`j]] Part[
                  StabililtyPackage`Private`A[StabililtyPackage`Private`j], 1,
                   2]; StabililtyPackage`Private`eqnb[
               StabililtyPackage`Private`j] = -Part[
                  StabililtyPackage`Private`Com[
                   StabililtyPackage`Private`Hb[StabililtyPackage`Private`j], 
                   StabililtyPackage`Private`Ab[StabililtyPackage`Private`j]],
                   1, 2] - Part[
                StabililtyPackage`Private`Com[
                 StabililtyPackage`Private`\[Delta]Hb[
                 StabililtyPackage`Private`j], 
                 StabililtyPackage`Private`\[Rho]b[
                 StabililtyPackage`Private`j]], 1, 2] + 
               StabililtyPackage`Private`k Cos[
                  Part[
                  StabililtyPackage`Private`\[Theta], 
                   StabililtyPackage`Private`j]] Part[
                  StabililtyPackage`Private`Ab[StabililtyPackage`Private`j], 
                  1, 2]; Null, {
             StabililtyPackage`Private`j, 1, StabililtyPackage`Private`n}]; 
           Return[{StabililtyPackage`Private`eqn, 
              StabililtyPackage`Private`eqnb, StabililtyPackage`Private`A, 
              StabililtyPackage`Private`Ab}]]]}], "SubValues" -> None, 
    "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> {"dh" -> True}, "Attributes" -> {}, "FullName" -> 
    "StabililtyPackage`getEquations"], False]]], "Output",
 CellChangeTimes->{{3.8013990546700478`*^9, 3.8013990683569994`*^9}, 
   3.8013991705960503`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"5c8f242e-ba66-44c8-916d-46fd6ffd0805"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"[data,test Energy, Hierarchy=1/-1]. Return elements \
of the hamiltonians\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False, False, False, False, 
                False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Definitions\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Definitions\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Definitions", "Tooltip"]& ], GridBox[{
                    {
                    RowBox[{
                    RowBox[{"buildHamiltonians", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data_", ",", 
                    "StabililtyPackage`Private`testE_", ",", 
                    "StabililtyPackage`Private`hi_", ",", 
                    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`n", ",", 
                    "StabililtyPackage`Private`\[Theta]", ",", 
                    "StabililtyPackage`Private`name11", ",", 
                    "StabililtyPackage`Private`name12", ",", 
                    "StabililtyPackage`Private`name21", ",", 
                    "StabililtyPackage`Private`name22", ",", 
                    "StabililtyPackage`Private`\[Rho]", ",", 
                    "StabililtyPackage`Private`\[Rho]b", ",", 
                    "StabililtyPackage`Private`A", ",", 
                    "StabililtyPackage`Private`Ab", ",", 
                    "StabililtyPackage`Private`Hm", ",", 
                    "StabililtyPackage`Private`Hvac", ",", 
                    "StabililtyPackage`Private`\[Mu]", ",", 
                    "StabililtyPackage`Private`\[Mu]b", ",", 
                    "StabililtyPackage`Private`Hsi", ",", 
                    "StabililtyPackage`Private`H", ",", 
                    "StabililtyPackage`Private`Hb", ",", 
                    "StabililtyPackage`Private`\[Delta]H", ",", 
                    "StabililtyPackage`Private`\[Delta]Hb", ",", 
                    "StabililtyPackage`Private`nudensity", ",", 
                    "StabililtyPackage`Private`nubardensity", ",", 
                    "StabililtyPackage`Private`Ve", ",", 
                    "StabililtyPackage`Private`\[Omega]", ",", 
                    "StabililtyPackage`Private`HsiRad", ",", 
                    "StabililtyPackage`Private`dhswitch"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"StabililtyPackage`Private`Ve", "=", 
                    FractionBox[
                    RowBox[{"StabililtyPackage`Private`munits", " ", 
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"Yes\"\>", 
                    "]"}], " ", 
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"matters\"\>", 
                    "]"}]}], "StabililtyPackage`Private`mp"]}], ";", 
                    RowBox[{"StabililtyPackage`Private`\[Omega]", "=", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Omega]EMev", "[", 
                    "StabililtyPackage`Private`testE", "]"}]}], ";", 
                    RowBox[{
                    "StabililtyPackage`Private`name11", "=", "\<\"ee\"\>"}], 
                    ";", 
                    RowBox[{
                    "StabililtyPackage`Private`name12", "=", "\<\"ex\"\>"}], 
                    ";", 
                    RowBox[{
                    "StabililtyPackage`Private`name21", "=", "\<\"xe\"\>"}], 
                    ";", 
                    RowBox[{
                    "StabililtyPackage`Private`name22", "=", "\<\"xx\"\>"}], 
                    ";", 
                    RowBox[{"StabililtyPackage`Private`n", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"mids\"\>", 
                    "]"}], "]"}]}], ";", 
                    RowBox[{"StabililtyPackage`Private`\[Theta]", "=", 
                    RowBox[{"ArcCos", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"mids\"\>", 
                    "]"}], "]"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Rho]", "[", 
                    "StabililtyPackage`Private`i", "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"\[Rho]\"\>", "<>", 
                    "StabililtyPackage`Private`name11", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"\[Rho]\"\>", "<>", 
                    "StabililtyPackage`Private`name12", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"\[Rho]\"\>", "<>", 
                    "StabililtyPackage`Private`name21", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"\[Rho]\"\>", "<>", 
                    "StabililtyPackage`Private`name22", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}]}], "}"}]}], "}"}]}], ";", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Rho]b", "[", 
                    "StabililtyPackage`Private`i", "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"\[Rho]b\"\>", "<>", 
                    "StabililtyPackage`Private`name11", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"\[Rho]b\"\>", "<>", 
                    "StabililtyPackage`Private`name12", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"\[Rho]b\"\>", "<>", 
                    "StabililtyPackage`Private`name21", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"\[Rho]b\"\>", "<>", 
                    "StabililtyPackage`Private`name22", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}]}], "}"}]}], "}"}]}], ";", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`A", "[", 
                    "StabililtyPackage`Private`i", "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"A\"\>", "<>", 
                    "StabililtyPackage`Private`name12", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"A\"\>", "<>", 
                    "StabililtyPackage`Private`name21", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}], ",", "0"}], "}"}]}], "}"}]}], ";", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`Ab", "[", 
                    "StabililtyPackage`Private`i", "]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"Ab\"\>", "<>", 
                    "StabililtyPackage`Private`name12", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToExpression", "[", 
                    
                    RowBox[{"\<\"Ab\"\>", "<>", 
                    "StabililtyPackage`Private`name21", "<>", 
                    RowBox[{
                    "ToString", "[", "StabililtyPackage`Private`i", "]"}]}], 
                    "]"}], ",", "0"}], "}"}]}], "}"}]}], ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`i", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}]}], "]"}], ";", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`nudensity", "[", 
                    "StabililtyPackage`Private`dt_", "]"}], ":=", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"StabililtyPackage`Private`dp", "=", "1"}], "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"StabililtyPackage`Private`f", "=", "1"}], 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"freqs\"\>", 
                    "]"}], "]"}], "-", "1"}]], 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"lotsodo\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    RowBox[{
                    "1", ",", "StabililtyPackage`Private`f", ",", 
                    "StabililtyPackage`Private`dt", ",", 
                    "StabililtyPackage`Private`dp"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"StabililtyPackage`Private`h", " ", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"freqmid\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    "StabililtyPackage`Private`f", "\[RightDoubleBracket]"}], 
                    " ", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"muss\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    RowBox[{"StabililtyPackage`Private`dt", "+", "1"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"muss\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    "StabililtyPackage`Private`dt", "\[RightDoubleBracket]"}]}
                    ], "]"}]}]]}], ")"}]}]}], ";", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`nubardensity", "[", 
                    "StabililtyPackage`Private`dt_", "]"}], ":=", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"StabililtyPackage`Private`dp", "=", "1"}], "2"], 
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"StabililtyPackage`Private`f", "=", "1"}], 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"freqs\"\>", 
                    "]"}], "]"}], "-", "1"}]], 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"lotsodo\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    RowBox[{
                    "2", ",", "StabililtyPackage`Private`f", ",", 
                    "StabililtyPackage`Private`dt", ",", 
                    "StabililtyPackage`Private`dp"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"StabililtyPackage`Private`h", " ", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"freqmid\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    "StabililtyPackage`Private`f", "\[RightDoubleBracket]"}], 
                    " ", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"muss\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    RowBox[{"StabililtyPackage`Private`dt", "+", "1"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"muss\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    "StabililtyPackage`Private`dt", 
                    "\[RightDoubleBracket]"}]}], "]"}]}]]}], ")"}]}]}], ";", 
                    RowBox[{"StabililtyPackage`Private`Hm", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"StabililtyPackage`Private`Ve", ",", "0.`"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "0.`"}], "}"}]}], "}"}]}], ";", 
                    RowBox[{"StabililtyPackage`Private`Hvac", "=", 
                    RowBox[{"StabililtyPackage`Private`hi", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["StabililtyPackage`Private`\[Omega]", "2"]}], 
                    ",", "0.`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", 
                    FractionBox["StabililtyPackage`Private`\[Omega]", "2"]}], 
                    "}"}]}], "}"}]}]}], ";", 
                    RowBox[{"StabililtyPackage`Private`\[Mu]", "=", 
                    RowBox[{"StabililtyPackage`Private`munits", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`nudensity", "[", 
                    "StabililtyPackage`Private`i", "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"muss\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    RowBox[{"StabililtyPackage`Private`i", "+", "1"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"muss\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    "StabililtyPackage`Private`i", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`i", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`j", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}]}], "]"}]}]}], ";", 
                    RowBox[{"StabililtyPackage`Private`\[Mu]b", "=", 
                    RowBox[{"StabililtyPackage`Private`munits", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`nubardensity", "[", 
                    "StabililtyPackage`Private`i", "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"muss\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    RowBox[{"StabililtyPackage`Private`i", "+", "1"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`data", "[", "\<\"muss\"\>", 
                    "]"}], "\[LeftDoubleBracket]", 
                    "StabililtyPackage`Private`i", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`i", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`j", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}]}], "]"}]}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\<\"dh\"\>", "]"}], ",", 
                    RowBox[{"StabililtyPackage`Private`dhswitch", "=", 
                    RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ",", 
                    RowBox[{"StabililtyPackage`Private`dhswitch", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "0.`"}], "}"}]}], "}"}]}]}], "]"}], 
                    ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`Hsi", "[", 
                    "StabililtyPackage`Private`j", "]"}], "=", 
                    RowBox[{
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"StabililtyPackage`Private`k", "=", "1"}], 
                    "StabililtyPackage`Private`n"], 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Mu]", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "StabililtyPackage`Private`k", ",", 
                    "StabililtyPackage`Private`j"}], 
                    "\[RightDoubleBracket]"}], " ", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Rho]", "[", 
                    "StabililtyPackage`Private`k", "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "\[Pi]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Theta]", 
                    "\[LeftDoubleBracket]", "StabililtyPackage`Private`j", 
                    "\[RightDoubleBracket]"}], "]"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Theta]", 
                    "\[LeftDoubleBracket]", "StabililtyPackage`Private`k", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], ")"}]}]}], "+", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"StabililtyPackage`Private`k", "=", "1"}], 
                    "StabililtyPackage`Private`n"], 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Mu]b", 
                    "\[LeftDoubleBracket]", 
                    RowBox[{
                    "StabililtyPackage`Private`k", ",", 
                    "StabililtyPackage`Private`j"}], 
                    "\[RightDoubleBracket]"}]}], " ", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Rho]b", "[", 
                    "StabililtyPackage`Private`k", "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", "\[Pi]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Theta]", 
                    "\[LeftDoubleBracket]", "StabililtyPackage`Private`j", 
                    "\[RightDoubleBracket]"}], "]"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    "StabililtyPackage`Private`\[Theta]", 
                    "\[LeftDoubleBracket]", "StabililtyPackage`Private`k", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], ")"}]}]}]}]}], 
                    ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`j", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}]}], "]"}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`H", "[", 
                    "StabililtyPackage`Private`i", "]"}], "=", 
                    RowBox[{
                    "StabililtyPackage`Private`Hvac", "+", 
                    "StabililtyPackage`Private`Hm", "+", 
                    RowBox[{
                    "StabililtyPackage`Private`Hsi", "[", 
                    "StabililtyPackage`Private`i", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`Hb", "[", 
                    "StabililtyPackage`Private`i", "]"}], "=", 
                    RowBox[{"StabililtyPackage`Private`Hvac", "-", 
                    "StabililtyPackage`Private`Hm", "-", 
                    RowBox[{
                    "StabililtyPackage`Private`Hsi", "[", 
                    "StabililtyPackage`Private`i", "]"}]}]}], ";", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Delta]H", "[", 
                    "StabililtyPackage`Private`i", "]"}], "=", 
                    RowBox[{"StabililtyPackage`Private`dhswitch", ".", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"StabililtyPackage`Private`j", "=", "1"}], 
                    "StabililtyPackage`Private`n"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Rho]", "[", 
                    "StabililtyPackage`Private`j", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]], 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`H", "[", 
                    "StabililtyPackage`Private`i", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", 
                    RowBox[{
                    "StabililtyPackage`Private`A", "[", 
                    "StabililtyPackage`Private`j", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Rho]b", "[", 
                    "StabililtyPackage`Private`j", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]], 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`H", "[", 
                    "StabililtyPackage`Private`i", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", 
                    RowBox[{
                    "StabililtyPackage`Private`Ab", "[", 
                    "StabililtyPackage`Private`j", "]"}]}]}], ")"}]}]}]}], 
                    ";", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Delta]Hb", "[", 
                    "StabililtyPackage`Private`i", "]"}], "=", 
                    RowBox[{"StabililtyPackage`Private`dhswitch", ".", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"StabililtyPackage`Private`j", "=", "1"}], 
                    "StabililtyPackage`Private`n"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Rho]", "[", 
                    "StabililtyPackage`Private`j", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]], 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`Hb", "[", 
                    "StabililtyPackage`Private`i", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", 
                    RowBox[{
                    "StabililtyPackage`Private`A", "[", 
                    "StabililtyPackage`Private`j", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`\[Rho]b", "[", 
                    "StabililtyPackage`Private`j", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]], 
                    RowBox[{
                    RowBox[{
                    "StabililtyPackage`Private`Hb", "[", 
                    "StabililtyPackage`Private`i", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", 
                    RowBox[{
                    "StabililtyPackage`Private`Ab", "[", 
                    "StabililtyPackage`Private`j", "]"}]}]}], ")"}]}]}]}], 
                    ";"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`i", ",", "1", ",", 
                    "StabililtyPackage`Private`n"}], "}"}]}], "]"}], ";", 
                    RowBox[{"Return", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "StabililtyPackage`Private`H", ",", 
                    "StabililtyPackage`Private`Hb", ",", 
                    "StabililtyPackage`Private`\[Rho]", ",", 
                    "StabililtyPackage`Private`\[Rho]b", ",", 
                    "StabililtyPackage`Private`A", ",", 
                    "StabililtyPackage`Private`Ab", ",", 
                    "StabililtyPackage`Private`\[Delta]H", ",", 
                    "StabililtyPackage`Private`\[Delta]Hb"}], "}"}], 
                    "]"}]}]}], "]"}]}]}
                    },
                    DefaultBaseStyle->"Column",
                    GridBoxAlignment->{"Columns" -> {{Left}}},
                    
                    GridBoxItemSize->{
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Options\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Options\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Options", "Tooltip"]& ], 
                   RowBox[{"\<\"\[Delta]h\"\>", "\[Rule]", "True"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"StabililtyPackage`buildHamiltonians\"\
\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->6], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"[data,test Energy, Hierarchy=1/-1]. Return elements \
of the hamiltonians\"\>", "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{15., {4., 11.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{15., {4., 11.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    "[data,test Energy, Hierarchy=1/-1]. Return elements of the hamiltonians",
     "Documentation" -> None, "OwnValues" -> None, "UpValues" -> None, 
    "DownValues" -> 
    Information`InformationValueForm[
     DownValues, StabililtyPackage`buildHamiltonians, {
      StabililtyPackage`buildHamiltonians[
         Pattern[StabililtyPackage`Private`data, 
          Blank[]], 
         Pattern[StabililtyPackage`Private`testE, 
          Blank[]], 
         Pattern[StabililtyPackage`Private`hi, 
          Blank[]], 
         OptionsPattern[]] :> 
       Module[{StabililtyPackage`Private`n, 
          StabililtyPackage`Private`\[Theta], 
          StabililtyPackage`Private`name11, StabililtyPackage`Private`name12, 
          StabililtyPackage`Private`name21, StabililtyPackage`Private`name22, 
          StabililtyPackage`Private`\[Rho], StabililtyPackage`Private`\[Rho]b,
           StabililtyPackage`Private`A, StabililtyPackage`Private`Ab, 
          StabililtyPackage`Private`Hm, StabililtyPackage`Private`Hvac, 
          StabililtyPackage`Private`\[Mu], StabililtyPackage`Private`\[Mu]b, 
          StabililtyPackage`Private`Hsi, StabililtyPackage`Private`H, 
          StabililtyPackage`Private`Hb, StabililtyPackage`Private`\[Delta]H, 
          StabililtyPackage`Private`\[Delta]Hb, 
          StabililtyPackage`Private`nudensity, 
          StabililtyPackage`Private`nubardensity, 
          StabililtyPackage`Private`Ve, StabililtyPackage`Private`\[Omega], 
          StabililtyPackage`Private`HsiRad, 
          StabililtyPackage`Private`dhswitch}, 
         StabililtyPackage`Private`Ve = 
          StabililtyPackage`Private`munits StabililtyPackage`Private`mp^(-1) 
           StabililtyPackage`Private`data["Yes"] 
           StabililtyPackage`Private`data["matters"]; 
         StabililtyPackage`Private`\[Omega] = 
          StabililtyPackage`Private`\[Omega]EMev[
           StabililtyPackage`Private`testE]; 
         StabililtyPackage`Private`name11 = "ee"; 
         StabililtyPackage`Private`name12 = "ex"; 
         StabililtyPackage`Private`name21 = "xe"; 
         StabililtyPackage`Private`name22 = "xx"; 
         StabililtyPackage`Private`n = Length[
            StabililtyPackage`Private`data["mids"]]; 
         StabililtyPackage`Private`\[Theta] = ArcCos[
            StabililtyPackage`Private`data["mids"]]; 
         Do[StabililtyPackage`Private`\[Rho][StabililtyPackage`Private`i] = {{
               ToExpression[
                StringJoin["\[Rho]", StabililtyPackage`Private`name11, 
                 ToString[StabililtyPackage`Private`i]]], 
               ToExpression[
                StringJoin["\[Rho]", StabililtyPackage`Private`name12, 
                 ToString[StabililtyPackage`Private`i]]]}, {
               ToExpression[
                StringJoin["\[Rho]", StabililtyPackage`Private`name21, 
                 ToString[StabililtyPackage`Private`i]]], 
               ToExpression[
                StringJoin["\[Rho]", StabililtyPackage`Private`name22, 
                 ToString[StabililtyPackage`Private`i]]]}}; 
           StabililtyPackage`Private`\[Rho]b[StabililtyPackage`Private`i] = {{
               ToExpression[
                StringJoin["\[Rho]b", StabililtyPackage`Private`name11, 
                 ToString[StabililtyPackage`Private`i]]], 
               ToExpression[
                StringJoin["\[Rho]b", StabililtyPackage`Private`name12, 
                 ToString[StabililtyPackage`Private`i]]]}, {
               ToExpression[
                StringJoin["\[Rho]b", StabililtyPackage`Private`name21, 
                 ToString[StabililtyPackage`Private`i]]], 
               ToExpression[
                StringJoin["\[Rho]b", StabililtyPackage`Private`name22, 
                 ToString[StabililtyPackage`Private`i]]]}}; 
           StabililtyPackage`Private`A[StabililtyPackage`Private`i] = {{0, 
               ToExpression[
                StringJoin["A", StabililtyPackage`Private`name12, 
                 ToString[StabililtyPackage`Private`i]]]}, {
               ToExpression[
                StringJoin["A", StabililtyPackage`Private`name21, 
                 ToString[StabililtyPackage`Private`i]]], 0}}; 
           StabililtyPackage`Private`Ab[StabililtyPackage`Private`i] = {{0, 
               ToExpression[
                StringJoin["Ab", StabililtyPackage`Private`name12, 
                 ToString[StabililtyPackage`Private`i]]]}, {
               ToExpression[
                StringJoin["Ab", StabililtyPackage`Private`name21, 
                 ToString[StabililtyPackage`Private`i]]], 0}}; Null, {
           StabililtyPackage`Private`i, 1, StabililtyPackage`Private`n}]; 
         StabililtyPackage`Private`nudensity[
            Pattern[StabililtyPackage`Private`dt, 
             Blank[]]] := Sum[
            Sum[Part[
               StabililtyPackage`Private`data["lotsodo"], 1, 
               StabililtyPackage`Private`f, StabililtyPackage`Private`dt, 
               StabililtyPackage`Private`dp]/(StabililtyPackage`Private`h Part[
               StabililtyPackage`Private`data["freqmid"], 
               StabililtyPackage`Private`f] Abs[Part[
                 StabililtyPackage`Private`data["muss"], 
                 StabililtyPackage`Private`dt + 1] - Part[
                StabililtyPackage`Private`data["muss"], 
                StabililtyPackage`Private`dt]]), {
             StabililtyPackage`Private`f, 1, Length[
                StabililtyPackage`Private`data["freqs"]] - 1}], {
            StabililtyPackage`Private`dp, 1, 2}]; 
         StabililtyPackage`Private`nubardensity[
            Pattern[StabililtyPackage`Private`dt, 
             Blank[]]] := Sum[
            Sum[Part[
               StabililtyPackage`Private`data["lotsodo"], 2, 
               StabililtyPackage`Private`f, StabililtyPackage`Private`dt, 
               StabililtyPackage`Private`dp]/(StabililtyPackage`Private`h Part[
               StabililtyPackage`Private`data["freqmid"], 
               StabililtyPackage`Private`f] Abs[Part[
                 StabililtyPackage`Private`data["muss"], 
                 StabililtyPackage`Private`dt + 1] - Part[
                StabililtyPackage`Private`data["muss"], 
                StabililtyPackage`Private`dt]]), {
             StabililtyPackage`Private`f, 1, Length[
                StabililtyPackage`Private`data["freqs"]] - 1}], {
            StabililtyPackage`Private`dp, 1, 2}]; 
         StabililtyPackage`Private`Hm = {{StabililtyPackage`Private`Ve, 0.}, {
            0., 0.}}; 
         StabililtyPackage`Private`Hvac = 
          StabililtyPackage`Private`hi {{-StabililtyPackage`Private`\[Omega]/
              2, 0.}, {0., StabililtyPackage`Private`\[Omega]/2}}; 
         StabililtyPackage`Private`\[Mu] = 
          StabililtyPackage`Private`munits 
           Table[StabililtyPackage`Private`nudensity[
              StabililtyPackage`Private`i] (Part[
                StabililtyPackage`Private`data["muss"], 
                StabililtyPackage`Private`i + 1] - Part[
               StabililtyPackage`Private`data["muss"], 
               StabililtyPackage`Private`i]), {
             StabililtyPackage`Private`i, 1, StabililtyPackage`Private`n}, {
             StabililtyPackage`Private`j, 1, StabililtyPackage`Private`n}]; 
         StabililtyPackage`Private`\[Mu]b = 
          StabililtyPackage`Private`munits 
           Table[StabililtyPackage`Private`nubardensity[
              StabililtyPackage`Private`i] (Part[
                StabililtyPackage`Private`data["muss"], 
                StabililtyPackage`Private`i + 1] - Part[
               StabililtyPackage`Private`data["muss"], 
               StabililtyPackage`Private`i]), {
             StabililtyPackage`Private`i, 1, StabililtyPackage`Private`n}, {
             StabililtyPackage`Private`j, 1, StabililtyPackage`Private`n}]; If[
           OptionValue["dh"], StabililtyPackage`Private`dhswitch = 
           IdentityMatrix[2], 
           StabililtyPackage`Private`dhswitch = {{0., 0.}, {0., 0.}}]; 
         Do[StabililtyPackage`Private`Hsi[StabililtyPackage`Private`j] = 
            Sum[Part[
                StabililtyPackage`Private`\[Mu], StabililtyPackage`Private`k, 
                 StabililtyPackage`Private`j] 
               StabililtyPackage`Private`\[Rho][StabililtyPackage`Private`k] (
                2 Pi) (1 - Cos[
                  Part[
                  StabililtyPackage`Private`\[Theta], 
                   StabililtyPackage`Private`j]] Cos[
                  Part[
                  StabililtyPackage`Private`\[Theta], 
                   StabililtyPackage`Private`k]]), {
               StabililtyPackage`Private`k, 1, StabililtyPackage`Private`n}] + 
             Sum[-Part[
                StabililtyPackage`Private`\[Mu]b, StabililtyPackage`Private`k,
                  StabililtyPackage`Private`j] 
               StabililtyPackage`Private`\[Rho]b[
                StabililtyPackage`Private`k] (2 Pi) (1 - Cos[
                  Part[
                  StabililtyPackage`Private`\[Theta], 
                   StabililtyPackage`Private`j]] Cos[
                  Part[
                  StabililtyPackage`Private`\[Theta], 
                   StabililtyPackage`Private`k]]), {
               StabililtyPackage`Private`k, 1, StabililtyPackage`Private`n}]; 
           Null, {StabililtyPackage`Private`j, 1, 
            StabililtyPackage`Private`n}]; 
         Do[StabililtyPackage`Private`H[StabililtyPackage`Private`i] = 
            StabililtyPackage`Private`Hvac + StabililtyPackage`Private`Hm + 
             StabililtyPackage`Private`Hsi[StabililtyPackage`Private`i]; 
           StabililtyPackage`Private`Hb[StabililtyPackage`Private`i] = 
            StabililtyPackage`Private`Hvac - StabililtyPackage`Private`Hm - 
             StabililtyPackage`Private`Hsi[StabililtyPackage`Private`i]; 
           StabililtyPackage`Private`\[Delta]H[StabililtyPackage`Private`i] = 
            Dot[StabililtyPackage`Private`dhswitch, 
              Sum[D[
                  Part[
                   StabililtyPackage`Private`H[StabililtyPackage`Private`i], 
                   1, 2], 
                  Part[
                   StabililtyPackage`Private`\[Rho][
                   StabililtyPackage`Private`j], 1, 2]] 
                StabililtyPackage`Private`A[StabililtyPackage`Private`j] + D[
                  Part[
                   StabililtyPackage`Private`H[StabililtyPackage`Private`i], 
                   1, 2], 
                  Part[
                   StabililtyPackage`Private`\[Rho]b[
                   StabililtyPackage`Private`j], 1, 2]] 
                StabililtyPackage`Private`Ab[StabililtyPackage`Private`j], {
               StabililtyPackage`Private`j, 1, StabililtyPackage`Private`n}]]; 
           StabililtyPackage`Private`\[Delta]Hb[StabililtyPackage`Private`i] = 
            Dot[StabililtyPackage`Private`dhswitch, 
              Sum[D[
                  Part[
                   StabililtyPackage`Private`Hb[StabililtyPackage`Private`i], 
                   1, 2], 
                  Part[
                   StabililtyPackage`Private`\[Rho][
                   StabililtyPackage`Private`j], 1, 2]] 
                StabililtyPackage`Private`A[StabililtyPackage`Private`j] + D[
                  Part[
                   StabililtyPackage`Private`Hb[StabililtyPackage`Private`i], 
                   1, 2], 
                  Part[
                   StabililtyPackage`Private`\[Rho]b[
                   StabililtyPackage`Private`j], 1, 2]] 
                StabililtyPackage`Private`Ab[StabililtyPackage`Private`j], {
               StabililtyPackage`Private`j, 1, StabililtyPackage`Private`n}]]; 
           Null, {StabililtyPackage`Private`i, 1, 
            StabililtyPackage`Private`n}]; 
         Return[{StabililtyPackage`Private`H, StabililtyPackage`Private`Hb, 
            StabililtyPackage`Private`\[Rho], 
            StabililtyPackage`Private`\[Rho]b, StabililtyPackage`Private`A, 
            StabililtyPackage`Private`Ab, StabililtyPackage`Private`\[Delta]H,
             StabililtyPackage`Private`\[Delta]Hb}]]}], "SubValues" -> None, 
    "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> {"\[Delta]h" -> True}, "Attributes" -> {}, "FullName" -> 
    "StabililtyPackage`buildHamiltonians"], False]]], "Output",
 CellChangeTimes->{{3.8013990546700478`*^9, 3.8013990683569994`*^9}, 
   3.801399170650054*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"416daac5-8c1f-4fb3-9185-985c3c2fe0f1"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.801399084087366*^9, 3.801399087740158*^9}, 
   3.8013991807592354`*^9},ExpressionUUID->"83ca9afe-1c30-45ea-a60e-\
ed93027e22b8"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.801399174444874*^9, 
  3.8013991775285454`*^9}},ExpressionUUID->"e096ea8e-02aa-46dc-bcee-\
75a6cf5d9c87"],

Cell[BoxData["h"], "Output",
 CellChangeTimes->{3.801399175019006*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"b5bd23ba-b78a-40fa-b6b5-26159d39cf67"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.801399091513973*^9, 
  3.8013990946696653`*^9}},ExpressionUUID->"e4d5f45b-4fc8-4c3a-adc8-\
f4603e635208"],

Cell[BoxData["h"], "Output",
 CellChangeTimes->{3.801399092841261*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"28d15530-c6b6-4b43-ab5a-093b5bc13aee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checks:", "Subsubsection",
 CellChangeTimes->{{3.8013144105153327`*^9, 
  3.8013144127207947`*^9}},ExpressionUUID->"f0af4d1c-7ee4-454c-ab7b-\
e2dd47595ba0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"OldData", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.61019", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", 
         RowBox[{"1.12835", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "18"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.8674", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"7.11518", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "19"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3.14996", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", 
         RowBox[{"1.13532", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3.46036", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.12664", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3.80135", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", 
         RowBox[{"1.11669", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"4.17594", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.10578", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"4.58744", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", 
         RowBox[{"1.09417", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"5.03949", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.08207", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"5.53608", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", 
         RowBox[{"1.06968", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"6.08162", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.05717", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"6.68091", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", 
         RowBox[{"1.04469", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"7.33925", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.03234", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"8.06247", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", 
         RowBox[{"1.02023", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"8.85695", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.00844", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"9.72973", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", 
         RowBox[{"9.97028", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "22"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.06885", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"9.86047", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "22"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.17418", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"9.75532", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "22"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.28988", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"9.78299", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "22"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.41699", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"9.85668", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "22"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.55662", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"9.92358", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "22"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.71001", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"9.98434", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "22"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.87852", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.00395", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.06363", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"1.00897", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.26698", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.01353", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.49037", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"1.01767", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.73577", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.02144", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3.00536", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"1.02487", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3.30151", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.02798", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3.62685", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"1.03082", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"3.98424", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.03339", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"4.37685", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"1.03574", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"4.80815", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.03787", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"5.28195", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"1.03981", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"5.80244", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.04157", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"6.37422", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"1.04318", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"7.00235", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.04464", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"7.69236", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"1.04597", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"8.45038", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.04718", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"9.28309", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"1.04828", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.01979", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.04928", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.12028", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", 
         RowBox[{"1.05019", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.23067", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.05102", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.35194", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", 
         RowBox[{"1.05178", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.48516", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.05247", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.63151", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", 
         RowBox[{"1.05309", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.79228", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.05366", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1.9689", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", 
         RowBox[{"1.05418", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.16292", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.05465", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.37605", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", 
         RowBox[{"1.05508", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2.61019", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.05547", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2.61019"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", 
         RowBox[{"1.44396", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3.3261"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", "\n", "   ", 
         RowBox[{"1.36214", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4.23837"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.29781", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "5.40084"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.24715", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "6.88216"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.20722", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "8.76976"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "17"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.17574", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.11751"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.15093", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.42401"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.13139", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.81459"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", 
         RowBox[{"1.116", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2.31228"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.10389", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2.94648"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.09436", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3.75463"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.08687", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4.78443"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.08098", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "6.09668"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.07635", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "7.76884"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.07272", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "9.89964"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "16"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.06986", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.26149"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.06762", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.60748"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.06586", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2.04837"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", "\n", "  ", 
         RowBox[{"1.06448", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2.61019"}], "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "15"}]}]}], ",", " ", 
         RowBox[{"1.06339", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "21"}]}]}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"kdebug", "=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", ",", 
         RowBox[{"ri", "=", "200"}], ",", 
         RowBox[{"testE", "=", "20"}], ",", 
         RowBox[{"hi", "=", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"k", "=", "0"}], ",", "kvar"}], "}"}], ",", "\n", 
       RowBox[{
        RowBox[{"file", "=", 
         RowBox[{"inpath", "<>", "\"\<1D_withV_withPairBrems_DO.h5\>\""}]}], 
        ";", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"SCalcScale", "[", 
            RowBox[{
             RowBox[{"ImportData", "[", 
              RowBox[{"inpath", "<>", "file", "<>", "\"\<.h5\>\""}], "]"}], 
             ",", "ri", ",", "testE", ",", "hi", ",", "0"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "//", "MatrixForm"}], "*)"}], "\n", 
        RowBox[{"(*", 
         RowBox[{"buildkGrid", "[", 
          RowBox[{
           RowBox[{"ImportData", "[", 
            RowBox[{"inpath", "<>", "file", "<>", "\"\<.h5\>\""}], "]"}], ",",
            "ri", ",", "testE", ",", "hi", ",", "40"}], "]"}], "*)"}], "\n", 
        RowBox[{"kAdapt", "[", 
         RowBox[{
         "file", ",", "ri", ",", "ri", ",", "testE", ",", "hi", ",", "10"}], 
         "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
   RowBox[{"ListLogPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"kdebug", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"kdebug", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}]}], ",", 
       "OldData"}], "}"}], ",", 
     RowBox[{"ImageSize", "->", " ", 
      RowBox[{"Scaled", "[", "0.65", "]"}]}]}], "]"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"2", "x2", " ", "matrix", " ", "check"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"get2bdata", "[", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "S2ba", ",", "S2b", ",", "data2b", ",", "fakeEn", ",", "c", ",", "h", 
         ",", "hbar", ",", "Gf", ",", "everg", ",", "Geverg", ",", "munits"}],
         "}"}], ",", "\n", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"2.99792458", " ", 
          RowBox[{"10", "^", "10"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"cm", "/", "s"}], "*)"}], "\n", 
        RowBox[{"h", "=", 
         RowBox[{"6.6260755", " ", 
          RowBox[{"10", "^", 
           RowBox[{"-", "27"}]}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"erg", " ", "s"}], "*)"}], "\n", 
        RowBox[{"hbar", " ", "=", " ", 
         RowBox[{"h", "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "Pi"}], ")"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"erg", " ", "s"}], "*)"}], "\n", 
        RowBox[{"Gf", "=", 
         RowBox[{"1.1663787", " ", 
          RowBox[{"10", "^", 
           RowBox[{"-", "5"}]}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{"GeV", "^", 
          RowBox[{"-", "2"}]}], "*)"}], "\n", 
        RowBox[{"everg", "=", 
         RowBox[{"1.60218", " ", 
          RowBox[{"10", "^", 
           RowBox[{"-", "12"}]}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"convert", " ", "eV", " ", "to", " ", "ergs"}], "*)"}], "\n", 
        RowBox[{"Geverg", " ", "=", " ", 
         RowBox[{"everg", "*", 
          RowBox[{"10", "^", "9"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"convert", " ", "GeV", " ", "to", " ", "ergs"}], " ", "*)"}],
         "\n", 
        RowBox[{"munits", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"Gf", "/", 
            RowBox[{"Geverg", "^", "2"}]}], " ", ")"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"hbar", " ", "c"}], ")"}], "^", "3"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Sqrt", "[", "2", "]"}], " ", "Gf", " ", "in", " ", "erg", 
          " ", 
          RowBox[{"cm", "^", "3"}]}], "*)"}], "\n", 
        RowBox[{"data2b", "=", "\[IndentingNewLine]", " ", 
         RowBox[{"Association", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<muss\>\"", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], ",", "\n", 
           RowBox[{"\"\<matters\>\"", "\[Rule]", " ", "0."}], ",", "\n", 
           RowBox[{"\"\<Yes\>\"", "\[Rule]", " ", "0."}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<mids\>\"", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<freqs\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<lotsodo\>\"", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "+", "a"}], ")"}], ",", "0."}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0.", ",", "0."}], "}"}]}], "}"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0.", ",", "0."}], "}"}], ",", 
                 RowBox[{"{", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "a"}], ")"}], ",", "0."}], "}"}]}], 
                "}"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", " ", 
           RowBox[{"\"\<freqmid\>\"", "\[Rule]", " ", 
            RowBox[{"{", "1", "}"}]}], ",", "\n", " ", 
           RowBox[{"\"\<munits\>\"", "\[Rule]", " ", "munits"}]}], 
          "\[IndentingNewLine]", "]"}]}]}]}], "\n", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"build2bMatrix", "[", "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fakeEn", ",", "S2ba", ",", "S2b"}], "}"}], ",", "\n", 
       RowBox[{
        RowBox[{"fakeEn", "=", "6.080273099999999`*^-22"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"MeV", " ", "input"}], ",", " ", 
          RowBox[{"output", " ", "in", " ", "ergs"}]}], "*)"}], "\n", 
        RowBox[{"S2ba", "=", 
         RowBox[{"stabilityMatrix", "[", 
          RowBox[{
           RowBox[{"get2bdata", "[", "]"}], ",", 
           RowBox[{"getEquations", "[", 
            RowBox[{
             RowBox[{"get2bdata", "[", "]"}], ",", "fakeEn", ",", 
             RowBox[{"-", "1"}], ",", "0."}], "]"}]}], "]"}]}], ";", "\n", 
        RowBox[{"S2b", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"S2ba", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"S2ba", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"S2ba", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"S2ba", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "4"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";",
         "\n", 
        RowBox[{"Return", "[", "S2b", "]"}]}]}], "\n", "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalOmega]ch", "[", 
      RowBox[{"k_", ",", "\[Mu]ch_", ",", "a_", ",", "\[Omega]_"}], "]"}], 
     "=", 
     RowBox[{
      RowBox[{"2", " ", "a", " ", "\[Mu]ch"}], "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"2", " ", "a", " ", "\[Mu]ch"}], ")"}], "2"], "+", 
        RowBox[{"\[Omega]", 
         RowBox[{"(", 
          RowBox[{"\[Omega]", "-", 
           RowBox[{"4", " ", "\[Mu]ch"}]}], ")"}]}]}]]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"evtest", "=", 
     RowBox[{
      RowBox[{"Eigenvalues", "[", 
       RowBox[{
        RowBox[{"build2bMatrix", "[", "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"a", "\[Rule]", " ", "0.1"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"vt", "=", 
    RowBox[{"VerificationTest", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Im", "[", 
          RowBox[{"\[CapitalOmega]ch", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"N", "[", 
             FractionBox["2.0929595558280123`*^-21", "2"], "]"}], ",", "0.1", 
            ",", "0.1"}], "]"}], "]"}], "]"}], "-", 
        RowBox[{"Abs", "[", 
         RowBox[{"Im", "[", "evtest", "]"}], "]"}]}], "<", 
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]]}], "\[IndentingNewLine]", ",", 
      RowBox[{"TestID", "\[Rule]", " ", "\"\<2 Beam Growth Rate\>\""}]}], 
     "]"}]}], "\n", "\n"}]}]], "Code",
 CellChangeTimes->{{3.80028160423571*^9, 3.8002816047648273`*^9}, 
   3.800284555211878*^9, 3.800614819183078*^9, {3.80061504795415*^9, 
   3.800615048204206*^9}, {3.8006235010533705`*^9, 3.80062350957418*^9}, {
   3.800623598432287*^9, 3.8006237038891926`*^9}, {3.8006238395431924`*^9, 
   3.80062385861625*^9}, {3.800874454437317*^9, 3.800874490343915*^9}, {
   3.800874697363285*^9, 3.800874789765874*^9}, {3.800875163334464*^9, 
   3.8008751708550887`*^9}, {3.800875538648567*^9, 3.800875567799795*^9}, {
   3.8008780046959105`*^9, 3.800878011264081*^9}, {3.8013142556463823`*^9, 
   3.8013142649823885`*^9}, {3.8013144270418434`*^9, 
   3.8013144339963446`*^9}, {3.8013144683666725`*^9, 
   3.8013144686057234`*^9}, {3.8013968035278687`*^9, 
   3.8013968347425184`*^9}, {3.801398628197669*^9, 3.8013986357972975`*^9}, {
   3.801398793319049*^9, 3.8013988380476313`*^9}, {3.8013992813509088`*^9, 
   3.8013993782346168`*^9}, {3.801399584243086*^9, 3.801399584946231*^9}, {
   3.8013996401800785`*^9, 3.8013996524937515`*^9}, {3.801400026375759*^9, 
   3.801400190791375*^9}, {3.801400232694352*^9, 3.8014002870199976`*^9}, {
   3.8014003512433047`*^9, 3.801400379539402*^9}, {3.801416216616076*^9, 
   3.8014162776720467`*^9}, {3.8014163093198357`*^9, 3.801416322313616*^9}, {
   3.8018187110675993`*^9, 3.801818712572913*^9}, {3.8018188877244215`*^9, 
   3.801818907141593*^9}, {3.8018190007929983`*^9, 3.8018190676804256`*^9}, {
   3.8018194726201143`*^9, 3.8018194766289787`*^9}, {3.8018195143911467`*^9, 
   3.8018195205264473`*^9}, {3.8018201387925305`*^9, 3.801820156466299*^9}, {
   3.801824031878535*^9, 3.801824034475089*^9}, {3.8018241142721415`*^9, 
   3.8018241166156416`*^9}, {3.801825387847642*^9, 3.801825389583007*^9}, {
   3.8018260496160307`*^9, 3.801826056127421*^9}, 3.801827258059784*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"03ce031f-4669-4bca-9be0-24e3076301b2"],

Cell[BoxData[
 GraphicsBox[{{}, {{
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.011000000000000001`], AbsoluteThickness[1.6], 
      PointBox[{{2.3639772986947037`*^-18, -41.28652789230698}, {
       6.577907259087188*^-18, -40.712298500244415`}, {
       1.830341769061953*^-17, -40.89084771925459}, {
       5.0930346987557535`*^-17, -48.16705174150502}, {
       1.4171671586789936`*^-16, -48.242545768167766`}, {
       3.9433518018813854`*^-16, -48.27516524458736}, \
{-3.9433518018813865`*^-19, -47.76751521331981}, {-3.943351801881405*^-18, \
-42.71879256271444}, {-3.943351801881395*^-17, -48.047840619966216`}, \
{-3.9433518018813854`*^-16, -48.228978452168825`}}]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.011000000000000001`], AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw903kwnGccwPEISxTpSAWRuNa1IdlI6or9MUyQJ45GVaLORCJEhFRIMo0j
Su2iMSQpi4TZssUyTakljlc9JI44thVLFds6o+xI3YqJ9MlMp3+8885n5pnn
nd/vna/+pRteV3bv2rXLhTzv3zbVhX1SjURQkzWVqRE4Yb3FJxrpnCTw7WFW
1U874YfLW3apjGQYs1hP19JGuEv8Rom7nALjOWJ5dR2EX7cYR/bNpcKSZ4LQ
RhfhQNVNdv6+NNhpr424q4fw8qVVsSQ6A2J1EpBYH+G+bLfETeVMoHXmVDoY
IBzfrD39y1wWaM4VKDYaIixr3pAezXkAZX+fSWUZI7xa9Nqa7/gIRGEDpdgE
4RwHiV64SQ6Mtx8+53IYYdYFbbaKHReC2jN3ukwR/iY+NdOFkw+S4aI/nY8g
zAnI2+Oi9AQUAqNEjUcR/lZOml0vKoJchkRodIzME9ZRtiblwYBCoWyqOcKj
lXbW/bnFMOE09DGDON430ro9gg+huq0eJ8h5cZGENh9VCnRlz1JvJsI3pIyu
V/xycPM5+d19cr+ZVH8rZV8lSMuLNYfJ90+xByJjmn8A7Qb5cgvimruxir+d
qwIPq1szPDOEfx8/vy1dqoajiTSvg8Qz0ysjBXU1MHsoyaSYzLNcoUufK6uF
wjO1HhbEk2xnOavuZ+BY0CbXT+ZfV5mK96c3QkBacuFtYscPWw15tRSkCC7T
jIhflvlvjqW3wDufjtwRBsIyvK1PKa9WCC8568wlXnD9ntms8ByE10c+8iMO
vVxyVTT7AjLkGAI6sdBsxpC50QF/6aQpL5L9L+mWGnFsX8LYCy+bNmKvO1PG
K3U98PO4PCePOEZ4MfvATRF4F3/Nv0mcmVU5oNrwK+QHh9t5EodHXuGsBL0C
pdyNHXNi2Qp3ZjBTDBt0Ga4a8XXLx1W3zYaAOTNQs0X+f/EdQ8UGv2HIiGbI
TRFbPsiO0WgdgXiNTnYf8WjY2z2yIRLY/irHtpHY+rN3F54ZjgO/w/9eOfFk
WWfEZtMEjDbFeOcR7/e1KfSLmwKLvS4N6cS2DlYBvaEzIPLuCownjj1RYlOV
PAsLT3MdvyD+rw/K8Z61wGvnNH7ok6By60gKdT7kqmY3DeHHOurzjVFp1KnR
6aBtJYRN4qYELHoWRfnGaKmpItz5tMXJYOgRlRSoGmq/H+Ee1uDAoks+tShT
b8nTRPiQRrrfpBaPuoj0Vf0PIpxicDqiMpVP1QlMTe+/782noLfMuIKSuoas
uZO+PP+55h8mqKLse7u//In0tT40M+TGqqVyD6xyRaQvVubuKdW9TRS/LbH4
RzrC6lur3FFopcS8hepg0pvjhJvk+EY7JRx7/vkb4j9oJ+MS3vZQKs0spUDS
X081zSJssJ/q+oTOFhIPTiix8xqGKN7YBxabxNdm9SKOr41R5ZruTseMSJ8b
JbY2MZNUgf3Zel+j//dHzXMjXeOI/wXkNyWQ
       "]]}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.011000000000000001`], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.011000000000000001`], AbsoluteThickness[1.6]}, {}, {}, {}}, {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.011000000000000001`], AbsoluteThickness[1.6]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.011000000000000001`], AbsoluteThickness[1.6]}, {}, {}, {}}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, -48.97902680786499},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->Scaled[0.65],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{-1.406355*^-15, 
   2.61019*^-15}, {-48.97902680786499, -40.712298500244415`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{Automatic, 
     Charting`ScaledTicks[{Log, Exp}]}, {Automatic, {{-48.35428695287496, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "21"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-46.051701859880914`, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "20"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-43.74911676688687, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "19"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-41.44653167389282, 
       FormBox[
        TemplateBox[{"10", 
          RowBox[{"-", "18"}]}, "Superscript", SyntaxForm -> SuperscriptBox], 
        TraditionalForm], {0.01, 0.}}, {-50.65687204586901, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-49.96372486530906, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-49.558259757200894`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-49.270577684749114`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-49.047434133434905`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-48.86511257664095, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-48.71096189681369, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-48.57743050418917, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-48.459647468532786`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-47.66113977231502, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-47.25567466420685, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-46.96799259175507, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-46.74484904044086, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-46.5625274836469, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-46.40837680381964, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-46.27484541119512, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-46.15706237553874, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-45.35855467932097, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-44.95308957121281, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-44.66540749876102, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-44.44226394744681, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-44.25994239065286, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-44.1057917108256, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-43.97226031820108, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-43.85447728254469, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-43.055969586326924`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-42.65050447821876, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-42.36282240576698, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-42.13967885445277, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-41.95735729765881, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-41.803206617831556`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-41.66967522520703, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-41.55189218955065, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-40.753384493332874`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-40.34791938522471, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-40.060237312772934`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-39.837093761458725`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-39.654772204664766`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-39.500621524837506`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-39.36709013221299, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-39.249307096556606`, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-39.14394658089878, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-38.73848147279061, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-38.45079940033883, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}, {-38.22765584902462, 
       FormBox[
        TemplateBox[{0., 0.}, "Spacer2"], TraditionalForm], {0.005, 
       0.}}}}]]], "Output",
 CellChangeTimes->{
  3.8013996559055033`*^9, 3.801400194770239*^9, {3.8014002743982935`*^9, 
   3.8014003070354223`*^9}, 3.801400354171971*^9, 3.801400391891075*^9, {
   3.801416268245016*^9, 3.8014162812938404`*^9}, {3.801416317911665*^9, 
   3.8014163250482225`*^9}, 3.8018187162107253`*^9, 3.801819074058813*^9, 
   3.80181916998615*^9, 3.801819486424102*^9, 3.8018240416946526`*^9, 
   3.8018241199463773`*^9, {3.8018253685305057`*^9, 3.801825392875745*^9}, 
   3.801826060130299*^9, 3.801826803738083*^9, 3.8018269897142906`*^9, 
   3.8018272667026553`*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"55594a1e-6dfa-4590-8313-cf39325a568e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["TestResultObject",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquarePlusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[{
              InsetBox[
               BoxData[
                FormBox[
                 PaneBox[
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitExpressions", "SuccessIcon"]], Alignment -> Center, 
                  ImageSize -> 
                  Dynamic[{
                    Automatic, 3.5 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                 TraditionalForm]]]}, PlotRange -> {{0, 1}, {0, 1}}, 
             Background -> GrayLevel[0.93], Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], Frame -> True, 
             FrameTicks -> None, FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.55]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Outcome: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"Success\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Test ID: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"2 Beam Growth Rate\"", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource[
               "FEBitmaps", "SquareMinusIconMedium"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              Evaluator -> Automatic, Method -> "Preemptive"], 
             Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}]], 
            GraphicsBox[{
              InsetBox[
               BoxData[
                FormBox[
                 PaneBox[
                  DynamicBox[
                   FEPrivate`FrontEndResource[
                   "MUnitExpressions", "SuccessIcon"]], Alignment -> Center, 
                  ImageSize -> 
                  Dynamic[{
                    Automatic, 3.5 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                 TraditionalForm]]]}, PlotRange -> {{0, 1}, {0, 1}}, 
             Background -> GrayLevel[0.93], Axes -> False, AspectRatio -> 1, 
             ImageSize -> 
             Dynamic[{
               Automatic, 3.5 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}], Frame -> True, 
             FrameTicks -> None, FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.55]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Outcome: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"Success\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Test ID: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"2 Beam Growth Rate\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Input: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   TagBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"Im", "[", 
                    RowBox[{"\[CapitalOmega]ch", "[", 
                    RowBox[{"0.`", ",", 
                    RowBox[{"N", "[", 
                    FractionBox[
                    RowBox[{"\[LeftSkeleton]", "24", "\[RightSkeleton]"}], 
                    "2"], "]"}], ",", "0.1`", ",", "0.1`"}], "]"}], "]"}], 
                    "]"}], "-", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    "]"}]}], "<", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], 
                    Short[#, 
                    Rational[2, 3]]& ], ImageSize -> {{1, 500}, Automatic}, 
                   BaselinePosition -> Baseline, ContentPadding -> False, 
                   FrameMargins -> 0, StripOnInput -> True], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Expected output: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   TagBox["True", Short[#, 
                    Rational[2, 3]]& ], ImageSize -> {{1, 500}, Automatic}, 
                   BaselinePosition -> Baseline, ContentPadding -> False, 
                   FrameMargins -> 0, StripOnInput -> True], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Actual output: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   TagBox["True", Short[#, 
                    Rational[2, 3]]& ], ImageSize -> {{1, 500}, Automatic}, 
                   BaselinePosition -> Baseline, ContentPadding -> False, 
                   FrameMargins -> 0, StripOnInput -> True], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Time taken: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   TagBox[
                    
                    TemplateBox[{
                    "0``7.150514997831988", "\"s\"", "seconds", 
                    "\"Seconds\""}, "Quantity", SyntaxForm -> Mod], Short[#, 
                    Rational[2, 3]]& ], ImageSize -> {{1, 500}, Automatic}, 
                   BaselinePosition -> Baseline, ContentPadding -> False, 
                   FrameMargins -> 0, StripOnInput -> True], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  TestResultObject[
   Association[
   "TestClass" -> None, "TestIndex" -> 2, "TestID" -> "2 Beam Growth Rate", 
    "Outcome" -> "Success", "Input" -> HoldForm[Abs[
         Im[
          $CellContext`\[CapitalOmega]ch[0., 
           N[2.0929595558280123`*^-21/2], 0.1, 0.1]]] - Abs[
        Im[$CellContext`evtest]] < 10^(-3)], "ExpectedOutput" -> 
    HoldForm[True], "ActualOutput" -> HoldForm[True], 
    "ExpectedMessages" -> {}, "ActualMessages" -> {}, "AbsoluteTimeUsed" -> 
    Quantity[0``7.150514997831988, "Seconds"], "CPUTimeUsed" -> 
    Quantity[0., "Seconds"], "MemoryUsed" -> Quantity[232, "Bytes"]]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.8013996559055033`*^9, 3.801400194770239*^9, {3.8014002743982935`*^9, 
   3.8014003070354223`*^9}, 3.801400354171971*^9, 3.801400391891075*^9, {
   3.801416268245016*^9, 3.8014162812938404`*^9}, {3.801416317911665*^9, 
   3.8014163250482225`*^9}, 3.8018187162107253`*^9, 3.801819074058813*^9, 
   3.80181916998615*^9, 3.801819486424102*^9, 3.8018240416946526`*^9, 
   3.8018241199463773`*^9, {3.8018253685305057`*^9, 3.801825392875745*^9}, 
   3.801826060130299*^9, 3.801826803738083*^9, 3.8018269897142906`*^9, 
   3.801827266889697*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"423e3efc-b15c-4168-94c2-6ce55b3de594"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plotting Functions :", "Section",
 CellChangeTimes->{{3.8013143796907434`*^9, 
  3.801314389242815*^9}},ExpressionUUID->"778aca77-84ec-42b0-a8fa-\
8f72e30637b7"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"conplot", "[", 
      RowBox[{
      "pts_", ",", "title_", ",", "klower_", ",", "kupper_", ",", "export_"}],
       "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ppts", ",", "plotout"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ppts", "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
             SuperscriptBox["10", "5"]}], ",", 
            RowBox[{
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", 
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "/", 
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plotout", "=", 
         RowBox[{"ListContourPlot", "[", 
          RowBox[{"ppts", ",", 
           RowBox[{"PlotLegends", "\[Rule]", " ", "Automatic"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"klower", ",", "kupper"}], "}"}], ",", "All"}], 
             "}"}]}], ",", 
           RowBox[{"MaxPlotPoints", "\[Rule]", " ", "Infinity"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Radius (km)\>\"", ",", "\"\<k/\[Mu]\>\"", ",", "None", ",", 
              "\"\<\[CapitalOmega]/\[Mu]\>\""}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", " ", "title"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", " ", 
            RowBox[{"Scaled", "[", "0.4", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"export", "\[Equal]", "1"}], ",", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{
            "outpath", "<>", "title", "<>", "\"\<_contourplot.pdf\>\""}], ",",
             "plotout"}], "]"}]}], "]"}], ";", "\n", 
        RowBox[{"Return", "[", "plotout", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"conplotauto", "[", 
      RowBox[{"pts_", ",", "title_", ",", "export_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ppts", ",", "plotout"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ppts", "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
             SuperscriptBox["10", "5"]}], ",", 
            RowBox[{
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", 
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "/", 
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plotout", "=", 
         RowBox[{"ListContourPlot", "[", 
          RowBox[{"ppts", ",", 
           RowBox[{"PlotLegends", "\[Rule]", " ", "Automatic"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"All", ",", "All", ",", "All"}], "}"}]}], ",", 
           RowBox[{"MaxPlotPoints", "\[Rule]", " ", "Infinity"}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Radius (km)\>\"", ",", "\"\<k/\[Mu]\>\"", ",", "None", ",", 
              "\"\<\[CapitalOmega]/\[Mu]\>\""}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", " ", "title"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", " ", 
            RowBox[{"Scaled", "[", "0.4", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"export", "\[Equal]", "1"}], ",", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{
            "outpath", "<>", "title", "<>", "\"\<_contourplot.pdf\>\""}], ",",
             "plotout"}], "]"}]}], "]"}], ";", "\n", 
        RowBox[{"Return", "[", "plotout", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pointplot", "[", 
      RowBox[{"pts_", ",", "title_", ",", "export_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ppts", ",", "plotout"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ppts", "=", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"pts", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"pts", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], "/", 
             RowBox[{"pts", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "4"}], "]"}], "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plotout", "=", 
         RowBox[{"ListPointPlot3D", "[", 
          RowBox[{"ppts", ",", 
           RowBox[{"AxesLabel", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{
             "\"\<radius (cm)\>\"", ",", "\"\<k (erg)\>\"", ",", 
              "\"\<Im[\[CapitalOmega]] (erg)\>\""}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", " ", "title"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"All", ",", "All", ",", "All"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"Scaled", "[", "0.8", "]"}]}], ",", 
           RowBox[{"TicksStyle", "\[Rule]", " ", 
            RowBox[{"Directive", "[", "16", "]"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", " ", 
            RowBox[{"Directive", "[", "18", "]"}]}], ",", 
           RowBox[{"ColorFunction", "\[Rule]", " ", "\"\<Rainbow\>\""}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", " ", "Automatic"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", " ", "title"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"export", "\[Equal]", "1"}], ",", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{
            "outpath", "<>", "title", "<>", "\"\<_pointplot.pdf\>\""}], ",", 
            "plotout"}], "]"}]}], "]"}], ";", "\n", 
        RowBox[{"Return", "[", "plotout", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.801314297117218*^9, 3.8013143760159683`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"e6cd1b60-7959-440e-bb2d-f6c8db8172c3"]
}, Closed]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification->1.5,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (March 18, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f56712fa-03f2-4ec6-a2fa-16ad4c94a45f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4169, 99, 822, "Input",ExpressionUUID->"91436ba2-a31f-4384-98d7-fc2cb56064d1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[4752, 123, 298, 6, 97, "Input",ExpressionUUID->"bdb6e7cd-c239-47d9-b167-de18ebb8b40a",
 InitializationCell->True],
Cell[5053, 131, 461, 6, 49, "Output",ExpressionUUID->"e8c1305f-90e1-4c90-a016-918bdadb931d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5551, 142, 323, 5, 102, "Input",ExpressionUUID->"bdd8f3fb-c826-41e0-b21f-cb454beab10c"],
Cell[5877, 149, 19650, 439, 145, "Output",ExpressionUUID->"0d74f071-1761-4185-ac38-8fd59b745e91"],
Cell[25530, 590, 22696, 494, 145, "Output",ExpressionUUID->"5c8f242e-ba66-44c8-916d-46fd6ffd0805"],
Cell[48229, 1086, 50307, 1054, 145, "Output",ExpressionUUID->"416daac5-8c1f-4fb3-9185-985c3c2fe0f1"]
}, Open  ]],
Cell[98551, 2143, 177, 3, 43, "Input",ExpressionUUID->"83ca9afe-1c30-45ea-a60e-ed93027e22b8"],
Cell[CellGroupData[{
Cell[98753, 2150, 154, 3, 43, "Input",ExpressionUUID->"e096ea8e-02aa-46dc-bcee-75a6cf5d9c87"],
Cell[98910, 2155, 148, 2, 49, "Output",ExpressionUUID->"b5bd23ba-b78a-40fa-b6b5-26159d39cf67"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99095, 2162, 154, 3, 43, "Input",ExpressionUUID->"e4d5f45b-4fc8-4c3a-adc8-f4603e635208"],
Cell[99252, 2167, 149, 2, 49, "Output",ExpressionUUID->"28d15530-c6b6-4b43-ab5a-093b5bc13aee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99438, 2174, 162, 3, 67, "Subsubsection",ExpressionUUID->"f0af4d1c-7ee4-454c-ab7b-e2dd47595ba0"],
Cell[CellGroupData[{
Cell[99625, 2181, 31239, 856, 2546, "Code",ExpressionUUID->"03ce031f-4669-4bca-9be0-24e3076301b2"],
Cell[130867, 3039, 10818, 244, 745, "Output",ExpressionUUID->"55594a1e-6dfa-4590-8313-cf39325a568e"],
Cell[141688, 3285, 9620, 201, 100, "Output",ExpressionUUID->"423e3efc-b15c-4168-94c2-6ce55b3de594"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151357, 3492, 167, 3, 99, "Section",ExpressionUUID->"778aca77-84ec-42b0-a8fa-8f72e30637b7"],
Cell[151527, 3497, 7731, 189, 768, "Input",ExpressionUUID->"e6cd1b60-7959-440e-bb2d-f6c8db8172c3",
 InitializationCell->True]
}, Closed]]
}
]
*)

